(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["controlPage"],{"7aec":function(t,e,a){},be7f:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-container",{staticClass:"px-5 mt-4",attrs:{id:"Controlproducts",fluid:""}},[a("b-row",{staticClass:"border-bottom border-secondary mx-5 px-5"},[a("b-col",{staticClass:"p-3 d-flex justify-content-between",attrs:{cols:"12"}},[a("h5",{staticClass:"m-0 d-inline-block"},[t._v("商品管理")]),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-1",modifiers:{"modal-1":!0}}]},[a("font-awesome-icon",{attrs:{icon:["fas","plus"],size:"lg"}})],1),a("b-modal",{attrs:{id:"modal-1",size:"lg",title:"新增商品","ok-only":""}},[a("b-form",{staticClass:"d-flex flex-wrap w-100",on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[a("b-form-group",{staticClass:"mr-auto",attrs:{id:"input-group-1",label:"商品名稱","label-for":"input-1"}},[a("b-form-input",{attrs:{id:"input-1",type:"text",placeholder:"請輸入商品名稱"},model:{value:t.productName,callback:function(e){t.productName=e},expression:"productName"}})],1),a("b-form-group",{attrs:{id:"input-group-2",label:"商品類別","label-for":"input-2"}},[a("b-form-input",{attrs:{id:"input-2",type:"text",placeholder:"請輸入商品類別"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1),a("b-form-group",{staticClass:"w-md-25",attrs:{id:"input-group-3",label:"商品價錢","label-for":"input-3"}},[a("b-form-input",{attrs:{id:"input-3",type:"number"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),a("b-form-group",{attrs:{id:"input-group-6",label:"商品數量","label-for":"input-6"}},[a("b-form-input",{attrs:{id:"input-6",type:"number"},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}})],1),a("b-form-group",{staticClass:"mx-2",attrs:{id:"input-group-4",label:"是否上架"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.是否上架;return[a("b-form-radio",{attrs:{"aria-describedby":s,name:"some-radios",value:"true"},model:{value:t.onsale,callback:function(e){t.onsale=e},expression:"onsale"}},[t._v("是")]),a("b-form-radio",{attrs:{"aria-describedby":s,name:"some-radios",value:"false"},model:{value:t.onsale,callback:function(e){t.onsale=e},expression:"onsale"}},[t._v("否")])]}}])}),a("b-form-group",{attrs:{id:"input-group-5",label:"商品說明","label-for":"input-5",description:"最多1000個字","invalid-feedback":"格式不符"}},[a("b-form-textarea",{attrs:{id:"input-5",type:"text",placeholder:"請輸入商品說明...",state:t.descState},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),a("b-form-group",{staticClass:"w-100 border-top pt-3",attrs:{id:"input-group-6"}},[a("label",{staticClass:"btn btn-info"},[a("input",{ref:"fileInput",staticClass:"mx-auto",staticStyle:{display:"none"},attrs:{id:"imagArr",type:"file","max-size":1024,exceedSizeText:"檔案大小不能超過",accept:"image/*",multiple:"",name:"file"},on:{change:t.uploadFile}}),a("font-awesome-icon",{attrs:{icon:["fas","folder-plus"],size:"lg"}}),t._v(" 上傳圖片 ")],1),a("br"),a("div",{staticClass:"d-flex flex-wrap w-100",attrs:{id:"showpic_all"}},t._l(t.priviewPic,(function(t,e){return a("div",{key:t,staticClass:"m-1",attrs:{id:"showpic"}},[a("img",{key:t,attrs:{src:t,"max-width":"100"}})])})),0)]),a("br"),a("br"),a("b-btn",{staticClass:"subbtn ml-auto",attrs:{type:"submit",variant:"success"}},[t._v("送出")])],1)],1)],1)],1),a("b-row",{staticClass:"mx-5 px-5"},[a("b-col",{staticClass:"mb-2",attrs:{cols:"12"}},[a("table",{attrs:{width:"100%"}},[a("tr",[a("td",{staticClass:"text-center",attrs:{width:"9%"}},[t._v("照片")]),a("td",{attrs:{width:"15%"}},[t._v("產品名稱")]),a("td",{attrs:{width:"15%"}},[t._v("分類")]),a("td",{attrs:{width:"14%"}},[t._v("售價")]),a("td",{attrs:{width:"15%"}},[t._v("數量")]),a("td",{attrs:{width:"16%"}},[t._v("是否上架")]),a("td")])])])],1),a("b-row",{staticClass:"mx-5 px-5"},t._l(t.products,(function(e,s){return a("b-col",{key:e._id,staticClass:"mb-2 product_item",attrs:{cols:"12"}},[a("b-card",{attrs:{width:"100%"}},[a("img",{directives:[{name:"pswp",rawName:"v-pswp",value:t.image,expression:"image"}],staticClass:"align-self-center float-left mr-4",attrs:{src:e.src,"img-left":""}}),a("div",{staticClass:"productright d-inline-block"},[e.edit?a("div",{staticClass:"productbox"},[a("table",{attrs:{width:"100%"}},[a("tr",[a("td",{staticClass:"px-4",attrs:{width:"120"}},[a("h5",[t._v("商品名稱:")]),a("b-form-input",{attrs:{type:"text",width:"80%"},model:{value:e.productNameModel,callback:function(a){t.$set(e,"productNameModel",a)},expression:"product.productNameModel"}})],1),a("td",{staticClass:"px-4",attrs:{width:"120"}},[a("p",[t._v("商品種類:")]),a("b-form-input",{attrs:{type:"text"},model:{value:e.typeModel,callback:function(a){t.$set(e,"typeModel",a)},expression:"product.typeModel"}})],1),a("td",{staticClass:"px-4",attrs:{width:"100"}},[a("p",[t._v("價格:")]),a("b-form-input",{attrs:{type:"number",state:t.descState},model:{value:e.priceModel,callback:function(a){t.$set(e,"priceModel",a)},expression:"product.priceModel"}})],1),a("td",{staticClass:"px-4",attrs:{width:"100"}},[a("p",[t._v("數量:")]),a("b-form-input",{attrs:{type:"number",state:t.descState},model:{value:e.quantityeModel,callback:function(a){t.$set(e,"quantityeModel",a)},expression:"product.quantityeModel"}})],1),a("td",{staticClass:"px-4",attrs:{width:"80"}},[a("b-form-group",{attrs:{id:"input-group-4",label:"是否上架"},scopedSlots:t._u([{key:"default",fn:function(s){var i=s.是否上架;return[a("b-form-radio",{attrs:{"aria-describedby":i,name:"some-radios",value:"true"},model:{value:e.onsaleModel,callback:function(a){t.$set(e,"onsaleModel",a)},expression:"product.onsaleModel"}},[t._v("是")]),a("b-form-radio",{attrs:{"aria-describedby":i,name:"some-radios",value:"false"},model:{value:e.onsaleModel,callback:function(a){t.$set(e,"onsaleModel",a)},expression:"product.onsaleModel"}},[t._v("否")])]}}],null,!0)})],1),a("td",{staticClass:"px-4",attrs:{width:"80"}},[e.edit?a("div",[a("b-btn",{staticClass:"m-1 float-right",attrs:{variant:"outline-danger"},on:{click:function(a){return t.cancel(e)}}},[t._v("取消")]),a("b-btn",{staticClass:"m-1 float-right",attrs:{variant:"outline-success"},on:{click:function(a){return t.save(e)}}},[t._v("保存")])],1):t._e()])]),a("tr",[a("td",{staticClass:"px-4",attrs:{colspan:"3"}},[a("p",[t._v("商品描述:")]),a("b-form-textarea",{attrs:{type:"text"},model:{value:e.descriptionModel,callback:function(a){t.$set(e,"descriptionModel",a)},expression:"product.descriptionModel"}})],1)])])]):a("div",{staticClass:"productbox"},[a("table",{attrs:{width:"100%"}},[a("tr",[a("td",{attrs:{width:"16%"}},[t._v(t._s(e.productName))]),a("td",{attrs:{width:"16%"}},[t._v(t._s(e.type))]),a("td",{attrs:{width:"16%"}},[t._v(t._s(t._f("thousands")(e.price)))]),a("td",{attrs:{width:"16%"}},[t._v(t._s(e.quantity))]),a("td",{attrs:{width:"16%"}},[t._v(t._s(e.onsale))]),a("td",{attrs:{width:"16%"}},[e.edit?t._e():a("div",[a("b-btn",{attrs:{variant:"outline-secondary"},on:{click:function(t){e.showDetail=!e.showDetail}}},[t._v("細項")]),a("b-btn",{staticClass:"m-1",attrs:{variant:"outline-success"},on:{click:function(a){return t.edit(e)}}},[t._v("編輯")]),a("b-btn",{staticClass:"m-1",attrs:{variant:"outline-danger"},on:{click:function(a){return t.del(e,s)}}},[t._v("刪除")])],1)])])])])]),a("div",{staticClass:"showProductDetail border-top mt-5 mx-3",class:{show_Detail:e.showDetail}},[a("h5",{staticClass:"my-3"},[t._v("商品描述:")]),!1===e.edit?a("span",[t._v(t._s(e.description))]):t._e(),a("div",{staticClass:"allpic d-flex flex-wrap mt-5"},t._l(e.img,(function(t){return a("div",{staticClass:"pic mx-2"},[a("img",{attrs:{src:t}})])})),0)])])],1)})),1)],1)},i=[],o=(a("a4d3"),a("e01a"),a("4160"),a("caad"),a("d81d"),a("a434"),a("d3b7"),a("2532"),a("3ca3"),a("159b"),a("ddb0"),a("2b3d"),a("b85c")),r={name:"ControlProduct",data:function(){return{productName:"",type:"",price:"",onsale:"",description:"",quantity:"",file:null,products:[],priviewPic:[],image:[]}},computed:{descState:function(){return 0===this.description.length?null:!(this.description.length>1e3)}},methods:{onSubmit:function(){var t=this,e=new FormData;e.append("productName",this.productName),e.append("type",this.type),e.append("price",this.price),e.append("quantity",this.quantity),e.append("onsale",this.onsale),e.append("description",this.description),this.image.forEach((function(t){e.append("file",t)})),this.axios.post("https://lifepluss.herokuapp.com/products/",e).then((function(e){e.data.result.src="https://lifepluss.herokuapp.com/products/images/"+e.data.result.images[0].file,e.data.result.productNameModel=e.data.result.productName,e.data.result.typeModel=e.data.result.type,e.data.result.priceModel=e.data.result.price,e.data.result.quantityeModel=e.data.result.quantity,e.data.result.onsaleModel=e.data.result.onsale,e.data.result.descriptionModel=e.data.result.description,e.data.result.edit=!1,e.data.result.showDetail=!1,delete e.data.result.file,t.products.push(e.data.result),t.image=[],t.description="",t.productName="",t.type="",t.price="",t.quantity="",t.onsale="",t.description="",console.log(e),t.$swal({icon:"success",title:"新增商品成功"}),t.priviewPic=[]})).catch((function(e){t.$swal({icon:"error",title:"錯誤",text:e.response.data.message})}))},cancel:function(t){t.edit=!1,t.productNameModel=t.productName,t.typeModel=t.type,t.priceModel=t.price,t.quantityeModel=t.quantity,t.onsaleModel=t.onsale,t.descriptionModel=t.description},save:function(t){var e=this;this.axios.patch("https://lifepluss.herokuapp.com/products/"+t._id,{productName:t.productNameModel,type:t.typeModel,price:t.priceModel,quantity:t.quantityeModel,onsale:t.onsaleModel,description:t.descriptionModel}).then((function(a){t.edit=!1,t.title=t.model,t.productName=t.productNameModel,t.type=t.typeModel,t.price=t.priceModel,t.quantity=t.quantityeModel,t.onsale=t.onsaleModel,t.description=t.descriptionModel,e.$alert.success("更新成功")})).catch((function(t){e.$alert.error(t.response.data.message)}))},edit:function(t){t.edit=!0},del:function(t,e){var a=this;this.axios.delete("https://lifepluss.herokuapp.com/products/"+t._id).then((function(t){t.data.success?(a.products.splice(e,1),a.$alert.success("刪除成功")):a.$alert.error(t.data.message)})).catch((function(t){a.$alert.error(t.response.data.message)}))},uploadFile:function(){this.image=[],this.priviewPic=[];var t,e=Object(o["a"])(this.$refs.fileInput.files);try{for(e.s();!(t=e.n()).done;){var a=t.value;a.size>1048576?(this.image=[],this.$swal({icon:"error",title:"錯誤",text:"圖片太大"})):a.type.includes("image")?this.image.push(a):(this.image=[],this.$swal({icon:"error",title:"錯誤",text:"檔案格式錯誤"}))}}catch(i){e.e(i)}finally{e.f()}for(var s=0;s<this.image.length;s++)this.priviewPic.push(URL.createObjectURL(this.image[s]))}},mounted:function(){var t=this;this.axios.get("https://lifepluss.herokuapp.com/products/").then((function(e){t.products=e.data.result.map((function(t){return t.images.length>0&&(t.src="https://lifepluss.herokuapp.com/products/images/"+t.images[0].file,t.img=[],t.images.forEach((function(e){t.img.push("https://lifepluss.herokuapp.com/products/images/"+e.file)}))),t.productNameModel=t.productName,t.typeModel=t.type,t.priceModel=t.price,t.quantityeModel=t.quantity,t.onsaleModel=t.onsale,t.descriptionModel=t.description,t.edit=!1,t.showDetail=!1,t}))})).catch((function(e){console.log(e),t.$alert.error(e.response.data.message)}))}},l=r,n=(a("c35e"),a("2877")),c=Object(n["a"])(l,s,i,!1,null,null,null);e["default"]=c.exports},c35e:function(t,e,a){"use strict";a("7aec")}}]);
//# sourceMappingURL=controlPage.3cd428f7.js.map